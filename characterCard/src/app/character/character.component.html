<div class="container py-5 mt-3">
    <div class="row">
        <div class="col d-flex mr-auto">

            <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                <button type="button" class="btn btn-primary" (click)="saveAll()" (click)="myProfile.saveProfileData()"
                    (click)="myCharacteristics.saveStatus()" (click)="mySkillList.saveSkillData()"
                    (click)="myBackstory.saveBackstorys()">
                    Save
                </button>
                <div class="btn-group mr-2" role="group">
                    <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    </button>
                    <div class="dropdown-menu bg-primary" style="width:50px;" aria-labelledby="btnGroupDrop1">
                        <div class="row" style="margin:0 15px;">
                            <a href="/" class="d-block w-100 text-white" data-toggle="modal"
                                data-target="#saveChCard">Save New</a>
                            <a [href]="jsonData" id="saveJson" class="d-block w-100 text-white" (click)="downloadJson()" target="_blank">Out Put</a>
                            <!-- <script>
                                // document.getElementById('saveJson').onclick = function (e) {
                                    function downloadJson(e){
                                    e.preventDefault(); // 阻止浏览器默认动作 (页面跳转)
                                    console.log('a');
                                    // window.open(this.href); // 在新窗口打开页面
                                };
                            </script> -->
                        </div>
                    </div>
                </div>
            </div>

            <button type="button" class="btn btn-primary mr-3" data-toggle="modal" data-target="#loadChCard">
                Load
            </button>
            <div class="d-flex justify-content-center align-items-center">
                角色卡名稱：<div class="h5 mr-3 mb-0">{{CHcard}}</div>
            </div>
        </div>

        <div class="col-2">
            <mutildice class="d-flex justify-content-end"></mutildice>
        </div>

    </div>


    <div class="text-center my-5">
        <img src="../../assets/coc-font.svg" alt="">
    </div>
    <div class="row mt-2">
        <div class="col">
            <div class="row">
                <div class="col-3">
                    <profile #myProfile [CHcard]="CHcard"></profile>
                </div>
                <div class="col-9">
                    <characteristics #myCharacteristics [CHcard]="CHcard"></characteristics>
                </div>
            </div>
        </div>
    </div>


    <!-- <button type="button" class="btn btn-primary mr-2" (click)="saveAll()" (click)="myProfile.saveProfileData()"
        (click)="myCharacteristics.saveStatus()" (click)="mySkillList.saveSkillData()"
        (click)="myBackstory.saveBackstorys()">
        Save All
    </button>
    <button type="button" class="btn btn-primary mr-2" (click)="myProfile.getProfileData()"
        (click)="myCharacteristics.getStatus()" (click)="mySkillList.getSkillData()"
        (click)="myBackstory.getBackstorys()">
        Load All
    </button> -->

    <skill-list #mySkillList [CHcard]="CHcard"></skill-list>
    <backstory #myBackstory [CHcard]="CHcard"></backstory>
    <div class="col d-flex mr-auto mb-3">
        <button type="button" class="btn btn-primary mr-2" (click)="saveAll()" (click)="myProfile.saveProfileData()"
            (click)="myCharacteristics.saveStatusItem()" (click)="myCharacteristics.saveStatusSubItems()"
            (click)="mySkillList.saveSkillData()" (click)="myBackstory.saveBackstorys()">
            Save All
        </button>
        <button type="button" class="btn btn-primary mr-2" (click)="myProfile.getProfileData()"
            (click)="myCharacteristics.getStatus()" (click)="mySkillList.getSkillData()"
            (click)="myBackstory.getBackstorys()">
            Load All
        </button>
    </div>

</div>



<!--Load Modal -->
<div class="modal fade" id="loadChCard" tabindex="-1" role="dialog" aria-labelledby="loadChCardLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body mt-2">
                <p class="text-center h5">請選擇角色卡</p>
                <div *ngFor="let c of chCardBox" class=" d-flex justify-content-center  align-items-center">
                    <input type="radio" name="c" value="c" class="mx-1" (click)="chooseCard(c)">{{c}}<br />
                </div>
                <button type="button" class="btn btn-primary d-flex mx-auto mt-3" data-dismiss="modal"
                    aria-label="Close" (click)="myProfile.getProfileData()" (click)="myCharacteristics.getStatus()"
                    (click)="mySkillList.getSkillData()" (click)="myBackstory.getBackstorys()">Load</button>
            </div>
            <div class="modal-body mt-2 border-top">
                <p class="text-center h5">讀取現成檔案</p>
                <p class="text-center"><small>※請以筆記本打開json檔，複製所有文字貼上</small></p>
                <input type="text" class="form-control">
                <button type="button" class="btn btn-primary">Load</button>

            </div>

        </div>
    </div>
</div>

<!--Save Modal -->
<div class="modal fade" id="saveChCard" tabindex="-1" role="dialog" aria-labelledby="saveChCardLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body mt-2">
                <div class="row d-flex justify-content-center">
                    <div class="col-12">
                        <h5 class="text-center">請輸入角色卡名稱</h5>
                    </div>
                    <div class="col-12 d-flex justify-content-center">
                        <input type="text" [(ngModel)]="addNewCHcardData">
                        <button type="button" class="btn btn-primary d-flex ml-2 mt-2" (click)="addNewTrue()"
                            (click)="addNewCHcard()">
                            Save
                        </button>
                    </div>
                    <div>
                        <div class="modal-footer border-0" [hidden]="!addNew">
                            <div class="col-12 mt-3 text-center">
                                <p class="mb-1">確認儲存此角色卡？</p>
                                <p class="text-danger"><small>※如果已有同名檔案，將會覆蓋原檔案！</small></p>
                                <!-- <button class="btn btn-danger" (click)="addNewFalse()" (mouseup)="saveAll()"
                                    (mouseup)="myProfile.saveProfileData()" (mouseup)="myCharacteristics.saveStatus()"
                                    (mouseup)="mySkillList.saveSkillData()" (mouseup)="myBackstory.saveBackstorys()">
                                    Yes
                                </button>
                                <button type="button" class="btn btn-outline-primary" (click)="addNewFalse()"
                                    (click)="DontSave()">No</button> -->
                                <button type="button" class="btn btn-danger mx-1" class="btn btn-danger"
                                    data-dismiss="modal" (click)="addNewFalse()" (mouseup)="saveAll()"
                                    (mouseup)="myProfile.saveProfileData()" (mouseup)="myCharacteristics.saveStatus()"
                                    (mouseup)="mySkillList.saveSkillData()"
                                    (mouseup)="myBackstory.saveBackstorys()">Save changes</button>
                                <button type="button" class="btn btn-outline-primary mx-1" data-dismiss="modal"
                                    (click)="addNewFalse()" (click)="DontSave()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>